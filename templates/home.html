<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - La Postal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="static/css/home.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}">
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark rounded-0">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('home') }}">
                LA POSTAL | DASHBOARD
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3">
                    Hola, <span class="user-name">{{ current_user.nombre }}</span>
                </span>
                <a class="nav-link" href="{{ url_for('perfil') }}">Perfil</a>
                <a class="nav-link" href="{{ url_for('logout') }}">Salir</a>
            </div>
        </div>
    </nav>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="dashboard-container">

        <div class="welcome-section">
            <h1 class="brand-title">LA POSTAL</h1>
            <p class="brand-subtitle">TERIYAKI & SUSHI</p>
            <p class="welcome-text">Bienvenido al sistema de gestión</p>
        </div>

        <!-- WRAP PARA NO PEGARSE A LOS LATERALES -->
        <div class="cards-wrap">
            <div class="cards-grid">

                <a href="/tabla" class="card-dashboard">
                    <div class="kanji-circle card-kanji">表</div>
                    <h3 class="card-title">Tabla Completa</h3>
                    <p class="card-desc">Visualización detallada de ventas diarias</p>
                </a>

                <a href="/resumen" class="card-dashboard">
                    <div class="kanji-circle card-kanji">月</div>
                    <h3 class="card-title">Resumen Mensual</h3>
                    <p class="card-desc">Análisis y estadísticas del mes en curso</p>
                </a>

                <a href="/comparativa" class="card-dashboard">
                    <div class="kanji-circle card-kanji">比</div>
                    <h3 class="card-title">Comparativa</h3>
                    <p class="card-desc">Análisis comparativo entre sucursales</p>
                </a>

                <a href="/ranking" class="card-dashboard">
                    <div class="kanji-circle card-kanji">位</div>
                    <h3 class="card-title">Ranking</h3>
                    <p class="card-desc">Clasificación de sucursales por desempeño</p>
                </a>

                <a href="{{ url_for('reporte_pedidos_semanales') }}" class="card-dashboard">
                    <div class="kanji-circle card-kanji">配</div>
                    <h3 class="card-title">Pedidos Semanales</h3>
                    <p class="card-desc">Comparativa semanal de pedidos Uber y Didi por sucursal</p>
                </a>

                <a href="/planeacion" class="card-dashboard">
                    <div class="kanji-circle card-kanji">計</div>
                    <h3 class="card-title">Jurídico</h3>
                    <p class="card-desc">Planificación estratégica y proyecciones</p>
                </a>

                <a href="{{ url_for('supervision') }}" class="card-dashboard">
                    <div class="kanji-circle card-kanji">監</div>
                    <h3 class="card-title">Supervisión</h3>
                    <p class="card-desc">Supervisión de sucursales</p>
                </a>

                <!-- RECURSOS HUMANOS -->
                <a href="/recursos-humanos" class="card-dashboard">
                    <div class="kanji-circle card-kanji">人</div>
                    <h3 class="card-title">Recursos Humanos</h3>
                    <p class="card-desc">Altas, bajas, incidencias, documentos y control de personal</p>
                </a>

                <!-- ADMINISTRACIÓN -->
                <a href="/administracion" class="card-dashboard">
                    <div class="kanji-circle card-kanji">管</div>
                    <h3 class="card-title">Administración</h3>
                    <p class="card-desc">Gestión operativa, reportes internos y control administrativo</p>
                </a>

                <!-- CAPACITACIÓN -->
                <a href="/capacitacion" class="card-dashboard">
                    <div class="kanji-circle card-kanji">教</div>
                    <h3 class="card-title">Capacitación</h3>
                    <p class="card-desc">Materiales, guías y seguimiento de entrenamientos por sucursal</p>
                </a>

                <!-- ATENCIÓN AL CLIENTE -->
                <a href="/atencion-al-cliente" class="card-dashboard">
                    <div class="kanji-circle card-kanji">客</div>
                    <h3 class="card-title">Atención al Cliente</h3>
                    <p class="card-desc">Seguimiento de casos, quejas, aclaraciones y satisfacción</p>
                </a>

                {% if current_user.id == 'Grafica' %}
                <a href="{{ url_for('reporte_semanal_grafica') }}" class="card-dashboard restricted">
                    <div class="kanji-circle card-kanji">週</div>
                    <h3 class="card-title">Reporte Semanal</h3>
                    <p class="card-desc">Visualización de datos semanales</p>
                </a>
                {% endif %}

            </div>
        </div>

    </div>

    <!-- IMAGEN DEL EQUIPO -->
    <div class="team-watermark">
        <img src="../static/logo personaje .png" alt="Equipo La Postal" class="team-watermark-photo">
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Variable para controlar si está en movimiento
        let estaHuyendo = false;

        function huirDelCursor(evt) {
            if (estaHuyendo) return; // Evita múltiples llamados simultáneos

            estaHuyendo = true;
            let target = evt.target;

            // Dimensiones de la ventana
            let maxWidth = window.innerWidth - target.offsetWidth;
            let maxHeight = window.innerHeight - target.offsetHeight;

            // Posición aleatoria
            let randomX = getRandomInt(0, maxWidth);
            let randomY = getRandomInt(0, maxHeight);

            // Movimiento más rápido sin transición
            target.style.transition = 'none';
            target.style.position = 'fixed'; // Usamos fixed para que sea relativo al viewport
            target.style.left = randomX + 'px';
            target.style.top = randomY + 'px';

            // Pequeña animación de "huida"
            target.style.transform = 'scale(0.95)';
            setTimeout(() => {
                target.style.transform = 'scale(1)';
                estaHuyendo = false;
            }, 200);

            // Evitar el comportamiento por defecto
            evt.preventDefault();
            evt.stopPropagation();
        }

        function evitarClick(evt) {
            // Intenta mover la imagen cuando hagan click
            huirDelCursor(evt);

            // Previene el click real
            evt.preventDefault();
            evt.stopPropagation();
            return false;
        }

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // También hace huir al Daruma si el cursor está cerca (sin tocar)
        document.addEventListener('mousemove', function (evt) {
            const daruma = document.querySelector('.team-watermark-photo');
            if (!daruma || estaHuyendo) return;

            const rect = daruma.getBoundingClientRect();
            const darumaCenterX = rect.left + rect.width / 2;
            const darumaCenterY = rect.top + rect.height / 2;

            // Calcula distancia entre cursor y Daruma
            const distanciaX = evt.clientX - darumaCenterX;
            const distanciaY = evt.clientY - darumaCenterY;
            const distancia = Math.sqrt(distanciaX * distanciaX + distanciaY * distanciaY);

            // Si el cursor está muy cerca (150px), huye
            if (distancia < 150) {
                const eventoSimulado = { target: daruma };
                huirDelCursor(eventoSimulado);
            }
        });
    </script>
</body>

</html>

